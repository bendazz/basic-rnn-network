<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Base RNN / LSTM Pre-Activation Network</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Base Neural Network</h1>
  </header>
  <main>
    <div class="global-controls">
      <div class="size-control">
        <label for="inputSize">Input Size: <span id="inputSizeValue">3</span></label>
        <input type="range" id="inputSize" min="1" max="5" value="3" />
      </div>
      <div class="size-control">
        <label for="hiddenSize">Hidden Size: <span id="sizeValue">3</span></label>
        <input type="range" id="hiddenSize" min="1" max="5" value="3" />
      </div>
      <div class="animation-controls">
        <button id="animateBtn" type="button">Animate Step</button>
        <button id="resetAnimBtn" type="button">Reset</button>
      </div>
    </div>
    <div class="panels-row">
      <div class="left-stack">
        <section class="panel">
          <div class="matrix-label">W<span class="sub">h</span> <span id="shapeWh" class="shape"></span></div>
          <div id="network-container" class="network-box" aria-label="Hidden state network"></div>
        </section>
        <section class="panel">
          <div class="matrix-label">W<span class="sub">x</span> <span id="shapeWx" class="shape"></span></div>
          <div id="network-container-2" class="network-box" aria-label="Input to hidden mapping network"></div>
        </section>
      </div>
      <section class="panel target-panel">
        <div class="matrix-label"><span id="shapeOut" class="shape"></span></div>
        <div id="target-container" class="network-box" aria-label="Target combined output panel"></div>
      </section>
    </div>
  </main>
  <hr class="section-divider" />
  <section class="content-section">
    <h2>RNN</h2>
    <div class="global-controls">
      <div class="size-control">
        <label for="rnnHiddenSize">Hidden Size: <span id="rnnHiddenValue">3</span></label>
        <input type="range" id="rnnHiddenSize" min="1" max="5" value="3" />
      </div>
      <div class="animation-controls">
        <button id="rnnAnimateBtn" type="button">Animate</button>
        <button id="rnnResetBtn" type="button">Reset</button>
      </div>
    </div>
    <section class="panel">
      <div id="rnn-vector-container" class="network-box" aria-label="RNN hidden vector panel"></div>
    </section>
  </section>
  <hr class="section-divider" />
  <section class="content-section">
    <h2>Forget Gate</h2>
    <div class="global-controls">
      <div class="size-control">
        <label for="forgetHiddenSize">Hidden Size: <span id="forgetHiddenValue">3</span></label>
        <input type="range" id="forgetHiddenSize" min="1" max="5" value="3" />
      </div>
      <div class="animation-controls">
        <button id="forgetAnimateBtn" type="button">Animate</button>
        <button id="forgetResetBtn" type="button">Reset</button>
      </div>
    </div>
    <section class="panel">
      <div id="forget-vector-container" class="network-box" aria-label="Forget gate vector panel"></div>
    </section>
  </section>
  <hr class="section-divider" />
  <section class="content-section">
    <h2>Input Gate</h2>
    <div class="global-controls">
      <div class="size-control">
        <label for="inputGateHiddenSize">Hidden Size: <span id="inputGateHiddenValue">3</span></label>
        <input type="range" id="inputGateHiddenSize" min="1" max="5" value="3" />
      </div>
      <div class="animation-controls">
        <button id="inputGateAnimateBtn" type="button">Animate</button>
        <button id="inputGateResetBtn" type="button">Reset</button>
      </div>
    </div>
    <div class="panels-row">
      <div class="left-stack">
        <section class="panel">
          <div id="input-gate-panel-1" class="network-box" aria-label="Input gate base panel"></div>
        </section>
        <section class="panel">
          <div id="input-gate-panel-2" class="network-box" aria-label="Input gate tanh panel"></div>
        </section>
      </div>
      <section class="panel input-gate-target-panel">
        <div id="input-gate-panel-3" class="network-box" aria-label="Input gate combined panel"></div>
      </section>
    </div>
  </section>
  <hr class="section-divider" />
  <section class="content-section">
    <h2>Output Gate</h2>
    <div class="global-controls">
      <div class="size-control">
        <label for="outputGateHiddenSize">Hidden Size: <span id="outputGateHiddenValue">3</span></label>
        <input type="range" id="outputGateHiddenSize" min="1" max="5" value="3" />
      </div>
      <div class="animation-controls">
        <button id="outputGateAnimateBtn" type="button">Animate</button>
        <button id="outputGateResetBtn" type="button">Reset</button>
      </div>
    </div>
    <div class="panels-row">
      <div class="left-stack">
        <section class="panel">
          <div id="output-gate-panel-1" class="network-box" aria-label="Output gate cell state (triangles)"></div>
        </section>
        <section class="panel">
          <div id="output-gate-panel-2" class="network-box" aria-label="Output gate comparison (squares)"></div>
        </section>
      </div>
      <section class="panel output-gate-target-panel">
        <div id="output-gate-panel-3" class="network-box" aria-label="Output gate combined panel"></div>
      </section>
    </div>
  </section>
  <hr class="section-divider" />
  <section class="content-section">
    <h2>LSTM Composite</h2>
    <div class="global-controls">
      <div class="animation-controls">
        <button id="lstmCompositeAnimateBtn" type="button">Step</button>
        <button id="lstmCompositeAnimateAllBtn" type="button">Run All</button>
        <button id="lstmCompositeResetBtn" type="button">Reset</button>
      </div>
    </div>
    <section class="panel">
      <div id="lstm-composite-container" class="network-box" aria-label="Full LSTM cell composite diagram"></div>
    </section>
  </section>
  <hr class="section-divider" />
  <section class="content-section" id="practice-section">
    <h2>Practice: Base RNN Cell</h2>
    <p class="practice-intro">Compute <code>h_next</code>.</p>
    <div class="practice-problems">
      <div class="practice-problem" data-problem="1">
        <h3>Problem 1 (hidden=4, input=3)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Problem 1
      import numpy as np
       x = np.array([[1.0],[0.5],[-1.0]])
       h_prev = np.array([[0.2],[-0.1],[0.05],[0.3]])
Wx = np.array([
 [0.3,  -0.2,  0.1],
 [0.0,   0.5, -0.4],
 [0.25,  0.15,-0.3],
 [-0.1,  0.2,  0.4],
])
Wh = np.array([
 [0.4,  -0.3,  0.0,  0.2],
 [-0.2,  0.1,  0.5, -0.1],
 [0.3,   0.2, -0.4,  0.1],
 [0.0,  -0.25, 0.35, 0.2],
])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
      <div class="practice-problem" data-problem="2">
        <h3>Problem 2 (hidden=3, input=2)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Problem 2
      import numpy as np
       x = np.array([[1.0],[-2.0]])
       h_prev = np.array([[0.4],[0.0],[-0.3]])
Wx = np.array([
 [0.6, -0.5],
 [0.2,  0.1],
 [-0.3, 0.4],
])
Wh = np.array([
 [0.2, -0.1, 0.0],
 [-0.4, 0.3, 0.5],
 [0.1, -0.2, 0.25],
])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
      <div class="practice-problem" data-problem="3">
        <h3>Problem 3 (hidden=5, input=4)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Problem 3
      import numpy as np
       x = np.array([[0.5],[-1.0],[1.5],[0.0]])
       h_prev = np.array([[0.1],[0.2],[-0.2],[0.0],[0.3]])
Wx = np.array([
 [0.1, -0.2,  0.3,  0.0],
 [0.4,  0.0, -0.1,  0.2],
 [-0.3, 0.25, 0.15, -0.05],
 [0.0,  0.3, -0.2,  0.4],
 [0.2, -0.1,  0.0,  0.1],
])
Wh = np.array([
 [0.2, -0.1,  0.05, 0.0,  0.1],
 [0.0,  0.3, -0.2,  0.1, -0.05],
 [0.25, 0.1, -0.4,  0.0,  0.2],
 [-0.1, 0.2,  0.3, -0.15, 0.05],
 [0.05,-0.2,  0.1,  0.25,-0.3 ],
])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
      <div class="practice-problem" data-problem="4">
        <h3>Problem 4 (hidden=3, input=3)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Problem 4
      import numpy as np
       x = np.array([[2.0],[-1.0],[0.5]])
       h_prev = np.array([[1.0],[-0.5],[0.0]])
Wx = np.array([
 [1.0, -2.0,  1.0],
 [0.0,  1.0, -1.0],
 [-1.0, 2.0,  0.0],
])
Wh = np.array([
 [2.0, -1.0, 0.0],
 [-1.0, 1.0,  1.0],
 [0.0, -2.0, 2.0],
])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
      <div class="practice-problem" data-problem="5">
        <h3>Problem 5 (hidden=4, input=2)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Problem 5
      import numpy as np
       x = np.array([[3.0],[-2.0]])
       h_prev = np.array([[0.5],[1.0],[-0.5],[0.0]])
Wx = np.array([
 [1.2, -0.8],
 [0.5,  1.1],
 [-1.0, 0.9],
 [0.7, -0.6],
])
Wh = np.array([
 [0.9, -0.5,  0.3,  0.2],
 [0.4,  0.8, -0.6,  0.0],
 [-0.7, 0.2,  1.0, -0.4],
 [0.3, -0.9,  0.5,  0.6],
])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
    </div>
  </section>
  <hr class="section-divider" />
  
  <hr class="section-divider" />
  <section class="content-section" id="sequence-practice-section">
    <h2>Practice: RNN Cell Sequence</h2>
    <p class="practice-intro">Unroll the RNN for the given number of cells (timesteps). Initial <code>h_0</code> is all zeros. Compute the final hidden state <code>h_T</code>. (We also show intermediate states.)</p>
    <div class="practice-problems sequence">
      <div class="practice-problem sequence-problem" data-seq-problem="S1">
        <h3>Sequence Problem S1 (T=3, hidden=3, input=2)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Sequence Problem S1
import numpy as np
T = 3  # timesteps
x_seq = [
    np.array([[1.0],[0.5]]),
    np.array([[0.0],[ -1.0]]),
    np.array([[2.0],[ 0.25]]),
]
Wx = np.array([
 [0.4, -0.3],
 [0.1,  0.5],
 [-0.2, 0.6],
])
Wh = np.array([
 [0.3, -0.1, 0.2],
 [-0.4, 0.25, 0.1],
 [0.5, -0.3, 0.4],
])
b = np.array([[0.05],[0.0],[ -0.1]])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
    </div>
  </section>

  <section class="content-section" id="forget-gate-practice-section">
    <h2>Practice: Forget Gate Only</h2>
    <p class="practice-intro">Given <code>x, h, C, Wx, Wh, Wf, b_f</code>, compute the forget gate activation and the resulting cell state update. We define:<br><code>v = Wx x + Wh h</code><br><code>z_f = Wf v + b_f</code><br><code>f = sigmoid(z_f)</code><br><code>C_out = f ⊙ C</code></p>
    <div class="practice-problems forget-gate">
      <div class="practice-problem forget-gate-problem" data-fg-problem="FG1">
        <h3>Forget Gate Problem FG1 (hidden=3, input=2)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Forget Gate Problem FG1
import numpy as np
x = np.array([[1.0],[-0.5]])
h = np.array([[0.2],[-0.1],[0.3]])
C = np.array([[0.5],[-0.25],[1.0]])
Wx = np.array([
 [0.4, -0.3],
 [0.1,  0.5],
 [-0.2, 0.6],
])
Wh = np.array([
 [0.3, -0.1, 0.2],
 [-0.4, 0.25, 0.1],
 [0.5, -0.3, 0.4],
])
Wf = np.array([
 [0.2,  0.1, -0.3],
 [-0.5, 0.4,  0.25],
 [0.3, -0.2,  0.6],
])
# bias for forget gate
b_f = np.array([[0.05],[-0.02],[0.10]])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-fg-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>

      <div class="practice-problem forget-gate-problem" data-fg-problem="FG2">
        <h3>Forget Gate Problem FG2 (hidden=4, input=3)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Forget Gate Problem FG2
import numpy as np
x = np.array([[0.5],[-1.0],[2.0]])
h = np.array([[0.1],[0.0],[-0.2],[0.3]])
C = np.array([[1.0],[-0.5],[0.25],[0.75]])
Wx = np.array([
 [0.3, -0.2, 0.4],
 [0.0,  0.6,-0.5],
 [0.25,0.15,-0.3],
 [-0.2,0.1, 0.35],
])
Wh = np.array([
 [0.4, -0.3, 0.0, 0.2],
 [-0.2, 0.1, 0.5, -0.1],
 [0.3,  0.2,-0.4,  0.1],
 [0.0, -0.25,0.35, 0.2],
])
Wf = np.array([
 [0.2, -0.1, 0.3, -0.4],
 [0.5,  0.0,-0.25, 0.2],
 [-0.3, 0.4, 0.1,  0.35],
 [0.25,-0.5, 0.2,  0.1],
])
# bias for forget gate
b_f = np.array([[0.00],[0.10],[-0.05],[0.20]])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-fg-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>

      <div class="practice-problem forget-gate-problem" data-fg-problem="FG3">
        <h3>Forget Gate Problem FG3 (hidden=2, input=3)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Forget Gate Problem FG3
import numpy as np
x = np.array([[-1.0],[0.25],[0.5]])
h = np.array([[0.6],[-0.4]])
C = np.array([[0.2],[1.25]])
Wx = np.array([
 [0.6, -0.4,  0.2],
 [-0.3, 0.5,  0.1],
])
Wh = np.array([
 [0.2, -0.1],
 [-0.25, 0.35],
])
Wf = np.array([
 [0.4, -0.2],
 [-0.3, 0.5],
])
# bias for forget gate
b_f = np.array([[0.02],[-0.03]])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-fg-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
    </div>
  </section>

  <section class="content-section" id="input-gate-practice-section">
    <h2>Practice: Input Gate Only</h2>
    <p class="practice-intro">Given <code>x, h, Wx, Wh, Wi, WC, b_i, b_C</code>, compute the input gate activation and the candidate cell contribution. We define:<br><code>v = Wx x + Wh h</code><br><code>z_i = Wi v + b_i</code><br><code>i = sigmoid(z_i)</code><br><code>z_C = WC v + b_C</code><br><code>C̃ = tanh(z_C)</code><br><code>Contribution = i ⊙ C̃</code> (elementwise multiply). Show intermediate vectors and the contribution.</p>
    <div class="practice-problems input-gate">
      <div class="practice-problem input-gate-problem" data-ig-problem="IG1">
        <h3>Input Gate Problem IG1 (hidden=3, input=2)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Input Gate Problem IG1
import numpy as np
x = np.array([[1.0],[ -0.5]])
h = np.array([[0.2],[ -0.1],[0.3]])
Wx = np.array([
 [0.4, -0.3],
 [0.1, 0.5],
 [-0.2, 0.6],
])
Wh = np.array([
 [0.3, -0.1, 0.2],
 [-0.4, 0.25, 0.1],
 [0.5, -0.3, 0.4],
])
Wi = np.array([
 [0.15, -0.05, 0.2],
 [-0.1, 0.3, 0.05],
 [0.25, -0.2, 0.1],
])
WC = np.array([
 [0.2, 0.1, -0.1],
 [-0.15, 0.25, 0.05],
 [0.05, -0.2, 0.3],
])
# cell state
C = np.array([[0.5],[ -0.25],[1.0]])
# biases
b_i = np.array([[0.02],[ -0.01],[0.03]])
b_C = np.array([[0.0],[0.04],[ -0.02]])
# v = Wx x + Wh h; z_i = Wi v + b_i; i = sigmoid(z_i)
# z_C = WC v + b_C; C_tilde = tanh(z_C); contribution = i * C_tilde
# final C' = C + contribution
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-ig-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
      <div class="practice-problem input-gate-problem" data-ig-problem="IG2">
        <h3>Input Gate Problem IG2 (hidden=4, input=3)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Input Gate Problem IG2
import numpy as np
x = np.array([[0.5],[ -1.0],[2.0]])
h = np.array([[0.1],[0.0],[ -0.2],[0.3]])
Wx = np.array([
 [0.3, -0.2, 0.4],
 [0.0, 0.6, -0.5],
 [0.25, 0.15, -0.3],
 [-0.2, 0.1, 0.35],
])
Wh = np.array([
 [0.4, -0.3, 0.0, 0.2],
 [-0.2, 0.1, 0.5, -0.1],
 [0.3, 0.2, -0.4, 0.1],
 [0.0, -0.25, 0.35, 0.2],
])
Wi = np.array([
 [0.2, -0.1, 0.3, -0.2],
 [0.1, 0.0, -0.25, 0.2],
 [-0.3, 0.4, 0.1, 0.35],
 [0.25, -0.15, 0.2, 0.1],
])
WC = np.array([
 [0.1, 0.05, -0.1, 0.2],
 [0.05, -0.02, 0.15, -0.05],
 [0.2, -0.1, 0.05, 0.1],
 [-0.1, 0.2, 0.05, 0.0],
])
# biases
b_i = np.array([[0.00],[0.05],[ -0.03],[0.08]])
b_C = np.array([[0.02],[ -0.01],[0.04],[0.0]])
C = np.array([[1.0],[ -0.5],[0.25],[0.75]])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-ig-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
      <div class="practice-problem input-gate-problem" data-ig-problem="IG3">
        <h3>Input Gate Problem IG3 (hidden=2, input=3)</h3>
        <button type="button" class="practice-copy-btn">Copy Arrays</button>
        <pre><code># Input Gate Problem IG3
import numpy as np
x = np.array([[ -1.0],[0.25],[ 0.5]])
h = np.array([[0.6],[ -0.4]])
Wx = np.array([
 [0.6, -0.4, 0.2],
 [-0.3, 0.5, 0.1],
])
Wh = np.array([
 [0.2, -0.1],
 [-0.25, 0.35],
])
Wi = np.array([
 [0.4, -0.2],
 [-0.3, 0.5],
])
WC = np.array([
 [0.3, -0.15],
 [-0.2, 0.25],
])
# biases
b_i = np.array([[0.01],[ -0.02]])
b_C = np.array([[0.0],[0.03]])
C = np.array([[0.2],[1.25]])
</code></pre>
        <div class="practice-answer">
          <button type="button" class="practice-show-ig-btn">Show Answer</button>
          <div class="practice-solution" hidden></div>
        </div>
      </div>
    </div>
  </section>
  <script src="script.js"></script>
</body>
</html>

